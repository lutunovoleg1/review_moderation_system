# Данные
## Датасет
Для обучения был выбран датасет [RuSentiment](https://huggingface.co/datasets/MonoHime/ru_sentiment_dataset). Он содержит около 200к публичных сообщений и комментариев из социальной сети ВКонтакте.

Тексты имеют разметку по тональности (0 — нейтральная, 1 — положительная, 2 — отрицательная).

Это хороший выбор, так как тексты из социальных сетей часто имеют особенности, которые важно учитывать при анализе тональности, например, сленг, сокращения и эмодзи.

## Эвристические признаки
На основе текстов были сформированы следующие эвристические признаки, которые можно использовать для обучения моделей:
- длина текста
- средняя длина слова
- доля знаков пунктуации
- доля "!"
- доля "?"
- доля капсовых слов
- доля капсовых букв
- доля уникальных слов
- доля стоп-слов
- доля положительных слов
- доля отрицательных слов
- доля слов усилителей
- доля слов ослабителей
- доля матов в тексте

EDA показал, что некоторые признаки позволяют неплохо разделять классы между собой, остальные — несут дополнительную информацию для модели.

# Модели
### CatBoost (text)
Модель CatBoostClassifier с использованием текстового признака — самого текста комментария.

### CatBoost (text + heuristic)
Модель CatBoostClassifier с использованием текстового признака и эвристических признаков, перечисленных выше.

### CatBoost (embeddings + heuristic)
Модель CatBoostClassifier с использованием эмбеддингов модели RuBERT-tiny2 и эвристических признаков, перечисленных выше.

### RuBERT (trained)
Обученная на датасете RuSentiment модель RuBERT с HuggingFace.

### RuBERT (finetuned)
Самостоятельно дообученная на датасете RuSentiment модель RuBERT с HuggingFace.

## Сравнение моделей
Для задачи были выбраны 3 основные метрики:
- Accuracy
- Precision_macro
- Recall_macro

По результатам исследования моделей имеем следующие метрики:

| Модель | Accuracy | Precision_macro | Recall_macro |
|---|---|---|---|
| CatBoost (text) |  0.7378 |  0.7288 |  0.7359 |
| CatBoost (text + heuristic) |  0.7725 |  0.7634 |  0.7654 |
| CatBoost (embeddings + heuristic) |  0.7437 |  0.7342 |  0.7288 |
| RuBERT (trained) |  0.6100 |  0.6000 |  0.5900 |
| RuBERT (finetuned) |  0.6848 |  0.6745 |  0.6559 |

# Итог
Лучшее качество показала модель CatBoost с текстовыми и эвристическими признаками. Также она работает достаточно быстро и не требует GPU.

Ее будем использовать в нашем сервисе.


